<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>People for People</title>
    <link rel="stylesheet" href="styles.css" />
    <script type="module" src="app.js"></script>

    <!-- Zus√§tzliche Styles: √úberg√§nge, Begr√º√üung, Chats, Kalender -->
    <style>
      /* ------------------------------
         √úberg√§nge und Begr√º√üungsbildschirm
      ------------------------------ */
      #registration-screen {
        opacity: 1;
        transition: opacity 0.6s ease;
      }
      #registration-screen.fade-out {
        opacity: 0;
      }
      #welcome-screen {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #27ae60, #8e44ad);
        color: #fff;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        font-family: Arial, sans-serif;
        padding: 20px;
        box-sizing: border-box;
        text-align: center;
        opacity: 0;
        transition: opacity 0.6s ease;
      }
      #welcome-screen.visible { opacity: 1; }
      #welcome-screen .logo { width: 180px; margin: 20px 0; }
      #welcome-screen .welcome-text { font-size: 4em; margin: 0.2em; }
      #welcome-screen .slogan {
        font-size: 1.5em; margin-top: 10px;
        opacity: 0; transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }
      #welcome-screen #start-btn {
        margin-top: 50px; opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }
      #welcome-screen .slogan.show,
      #welcome-screen #start-btn.show {
        opacity: 1; transform: translateY(0);
      }
      #welcome-screen.fade-out { opacity: 0; }
      @keyframes wave {
        0% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
        100% { transform: translateY(0); }
      }
      .wave-letter { display: inline-block; }
      .wave-letter.animate-wave { animation: wave 1.5s ease-in-out; }
      @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
      }
      #welcome-screen #start-btn.pulse { animation: pulse 1s infinite ease-in-out; }

      /* ------------------------------
         Styles f√ºr Chats im Vollbildmodus
      ------------------------------ */
      .chat-container:fullscreen {
        width: 100%; height: 100%; padding: 20px;
        box-sizing: border-box; background: #fff; position: relative;
      }
      .chat-container:fullscreen .chat-messages {
        height: calc(100% - 120px); overflow-y: auto;
      }
      .chat-container:fullscreen form {
        position: absolute; bottom: 20px; left: 20px; right: 20px; margin: 0;
      }
      .chat-header {
        display: flex; justify-content: space-between; align-items: center;
        background: #f2f2f2; padding: 10px; border-bottom: 1px solid #ccc;
      }
      .chat-header h3 { margin: 0; font-size: 1.2em; }
      .fullscreen-chat-btn {
        background: transparent; border: none; cursor: pointer; padding: 6px 10px;
      }
      .fullscreen-chat-btn img { width: 24px; height: 24px; }

      /* ------------------------------
         Styles f√ºr Kalender
      ------------------------------ */
      /* Der Kalenderbereich wird nur im Freiwilligenmodus angezeigt */
      #calendario {
        width: 100%; height: calc(100vh - 180px);
        padding: 20px; box-sizing: border-box;
        background: #f9f9f9; overflow: auto;
      }
      #calendar-container { width: 100%; height: calc(100% - 50px); display: block; }
      #calendar-controls { margin-bottom: 15px; }
      #calendar-controls button { margin-right: 10px; }
      .calendar-view-toggle {
        background: #e0e0e0; border: none; color: #333;
        padding: 10px 20px; border-radius: 5px; font-size: 1em;
        cursor: pointer; transition: background 0.3s, color 0.3s, transform 0.3s;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .calendar-view-toggle:hover,
      .calendar-view-toggle.active {
         background: #32cd32; color: #fff; transform: scale(1.05);
      }
      .calendar-add-event {
        background: #007BFF; border: none; color: #fff;
        padding: 10px 20px; border-radius: 5px; font-size: 1em;
        cursor: pointer; transition: background 0.3s, transform 0.3s;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .calendar-add-event:hover {
         background: #0056b3; transform: scale(1.05);
      }
      .daily-header-row {
        display: flex; justify-content: space-between; align-items: center;
        padding: 5px 10px; background: #e0e0e0; border-radius: 4px;
        margin-bottom: 10px; font-weight: bold;
      }
      .daily-header-row span { flex: 1; }
      .daily-list { display: flex; flex-direction: column; gap: 10px; }
      .daily-row {
        display: flex; align-items: center; padding: 8px; border: 1px solid #ddd;
        border-radius: 8px; background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        cursor: pointer;
      }
      .daily-row .day-name { width: 100px; font-weight: bold; color: #27ae60; }
      .daily-row .event-info { flex: 1; text-align: right; color: #333; }
      .monthly-header {
        display: grid; grid-template-columns: repeat(7, 1fr); margin-bottom: 10px;
      }
      .monthly-header div {
        text-align: center; font-weight: bold; padding: 5px 0;
        background: #e0e0e0; border-radius: 4px;
      }
      .monthly-grid { display: grid; grid-template-columns: repeat(7, 1fr);
         grid-auto-rows: 1fr; grid-gap: 10px; }
      .calendar-cell {
        min-width: 90px; border: 1px solid #ddd; border-radius: 8px; background: #fff;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; align-items: center;
        justify-content: center; position: relative; cursor: pointer; font-size: 0.9em;
        transition: background 0.3s, transform 0.3s;
      }
      .calendar-cell:hover {
        background: #e6f9e6; transform: scale(1.02);
      }
      #event-panel {
        display: none; position: fixed; top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        background: #fff; border: 1px solid #ccc; padding: 15px 15px 30px;
        border-radius: 6px; box-shadow: 2px 2px 10px rgba(0,0,0,0.3);
        z-index: 100; max-width: 400px; width: 90%; max-height: 70vh;
        overflow-y: auto;
      }
      #event-panel h3 { text-align: center; color: #8e44ad; margin-bottom: 15px; }
      #event-panel label {
        display: block; margin-bottom: 5px; font-weight: bold; color: #27ae60;
      }
      #event-panel input,
      #event-panel textarea,
      #event-panel select {
         width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box;
         border: 1px solid #ccc; border-radius: 4px;
      }
      #event-panel button {
        padding: 8px 12px; font-size: 0.9em; cursor: pointer;
        margin-right: 5px; border: none; border-radius: 4px;
      }
      #event-panel button:hover { opacity: 0.9; }

      /* Regel zum Anzeigen des Kalender-Buttons, wenn die Klasse "visible" vorhanden ist */
      #calendario-btn.visible {
        display: inline-block !important;
      }

      /* ------------------------------
         Restliche Styles (Profil, Modals, etc.)
      ------------------------------ */
      .terms-container {
        padding: 5px;
        margin: 10px 0;
        display: inline-flex;
        align-items: center;
        justify-content: flex-start;
        background: #fefefe;
        white-space: nowrap;
      }
      .terms-container label {
        margin-left: 5px;
        font-size: 0.9em;
      }
      .terms-link {
        color: blue;
        text-decoration: underline;
        cursor: pointer;
      }
      /* Styles f√ºr das Modal der Datenschutzbestimmungen (zentriert, ohne Kopfzeile) */
      #terms-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.8);
      }
      #terms-modal .modal-content {
        background: #fff;
        margin: 10% auto;
        padding: 20px;
        border: none;
        width: 90%;
        max-width: 800px;
        text-align: center;
        position: relative;
      }
      #terms-modal #close-terms {
        color: #aaa;
        position: absolute;
        top: 10px;
        right: 20px;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }
      #terms-modal img {
        display: block;
        margin: -10px auto 10px;
        max-width: 70%;
        height: auto;
        border: none;
        box-shadow: none;
      }
    </style>
  </head>
  <body>
    <!-- Begr√º√üungsnachricht / Prototyp -->
    <div id="dev-message">
      <div class="message-box">
        <p>
          Willkommen bei People for People. Dies ist ein Prototyp einer Anwendung f√ºr das Startup von People for People.
          Wir integrieren derzeit die neuesten Technologien und entwickeln neue Funktionen, um ein au√üergew√∂hnliches Nutzererlebnis zu bieten.
          Wir danken Ihnen, dass Sie an dieser Testphase teilnehmen.
        </p>
        <p class="creator">Erstellt von: Carlos Potenciano</p>
        <button id="accept-dev-message" class="accept-btn">Akzeptieren</button>
      </div>
    </div>

    <!-- Registrierungsbildschirm -->
    <div id="registration-screen" class="screen">
      <div class="form-container">
        <h2>Registrierung</h2>
        <form id="registration-form">
          <input type="text" id="username" placeholder="Benutzername" required />
          <input type="email" id="email" placeholder="E-Mail" required />
          <input type="password" id="password" placeholder="Passwort" required />
          <!-- Datenschutzbestimmungen -->
          <div class="terms-container">
            <input type="checkbox" id="accept-terms" required />
            <label for="accept-terms">Akzeptiere die <span class="terms-link" onclick="openTermsModal()">Datenschutzbestimmungen</span></label>
          </div>
          <button type="submit" class="enhanced-btn">Registrieren</button>
        </form>
      </div>
    </div>
    <button type="submit" class="enhanced-btn">Registrieren</button>

    <!-- Hauptanwendung (Freiwilligenmodus) -->
    <div id="main-app" class="screen" style="display: none;">
      <header class="app-header">
        <h1 class="app-title">People for People</h1>
        <div class="header-actions">
          <!-- Kalender-Icon (nur im Freiwilligenmodus sichtbar) -->
          <button id="calendario-btn" data-target="calendario" class="visible" style="cursor: pointer; background: transparent; border: none; margin-right: 10px;">
            <img src="https://github.com/CharliePoten/People-For-People/blob/main/calendario%20icono.png?raw=true" alt="Kalender" class="calendario-icon" style="width:28px; height:auto;" />
          </button>
          <!-- Profil-Button -->
          <div class="profile-container" id="profile-btn">
            <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20perfil.png?raw=true" alt="Profil" class="profile-img" onerror="this.onerror=null; this.src='https://github.com/CharliePoten/People-For-People/blob/main/icono%20perfil.png?raw=true'" />
            <span class="profile-label">Mein Profil</span>
            <div id="profile-dropdown" class="profile-dropdown" style="display: none;">
              <div class="dropdown-item" data-section="perfil">Mein Profil</div>
              <div class="dropdown-item" data-section="ajustes">Profileinstellungen</div>
              <div class="dropdown-item" data-section="soporte">Support</div>
              <div class="dropdown-item" data-section="centro">People for People</div>
              <!-- Button zum Wechsel in den Organisator-Modus -->
              <div class="dropdown-item mode-toggle-btn" style="background-color: #800080; color: white; cursor: pointer;">
                Zum Organisator wechseln
              </div>
            </div>
          </div>
        </div>
      </header>
      <main class="app-content" id="content">
        <!-- Kartenbereich -->
        <div id="map-view" class="content-section">
          <h2>Karte</h2>
          <div id="map-container">
            <div id="map"></div>
            <button id="fullscreen-btn">Vollbild</button>
          </div>
        </div>
        <!-- Hilfe anfordern -->
        <div id="pedir-ayuda" class="content-section" style="display:none;">
          <h2>Hilfe anfordern</h2>
          <div id="ayuda-view">
            <div id="ayuda-list-view">
              <button id="mostrar-ayuda-create" class="action-btn">Hilfepunkt erstellen</button>
              <div id="ayuda-list" class="list-box"></div>
            </div>
            <div id="ayuda-create-form" class="form-container" style="display:none;">
              <h3>Neuer Hilfepunkt</h3>
              <form id="crear-ayuda-form">
                <input type="text" id="ayuda-titulo" placeholder="Titel des Hilfepunkts" required />
                <textarea id="ayuda-info" placeholder="Informationen zum Hilfepunkt" required></textarea>
                <input type="file" id="ayuda-image" accept="image/*" />
                <button type="submit" class="action-btn">
                  <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20enviar.png?raw=true" class="send-icon" alt="Senden" />
                  Senden
                </button>
                <button type="button" id="cancelar-ayuda" class="return-btn">Zur√ºck</button>
              </form>
            </div>
            <div id="ayuda-detail-view" style="display:none;">
              <button id="volver-ayuda-list" class="return-btn">Zur√ºck</button>
              <div id="ayuda-detail"></div>
              <button id="view-on-map" class="map-btn">Auf der Karte anzeigen</button>
              <div id="small-map" style="height: 150px; width: 100%; margin-top: 10px;"></div>
              <div id="ayuda-chat" class="chat-container">
                <div class="chat-header">
                  <h3>Hilfe-Chat</h3>
                  <button type="button" class="fullscreen-chat-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/Pantalla%20completa.png?raw=true" alt="Vollbild" />
                  </button>
                </div>
                <div class="chat-messages" id="ayuda-chat-messages"></div>
                <form id="ayuda-chat-form">
                  <input type="text" id="ayuda-chat-input" placeholder="Schreibe deine Nachricht" required />
                  <button type="submit" class="enhanced-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20enviar.png?raw=true" class="send-icon" alt="Senden" />
                    Senden
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <!-- Freiwillige -->
        <div id="ofrecer-voluntario" class="content-section" style="display:none;">
          <h2>Freiwillige</h2>
          <div id="voluntario-view">
            <div id="voluntario-list-view">
              <button id="mostrar-voluntario-create" class="action-btn">Mich als Freiwilliger anbieten</button>
              <div id="voluntario-list" class="list-box"></div>
            </div>
            <div id="voluntario-create-form" class="form-container" style="display:none;">
              <h3>Verf√ºgbare Zeiten</h3>
              <form id="crear-voluntario-form">
                <div class="slider-group">
                  <label for="dia-inicio">Starttag: <span id="dia-inicio-label">Montag</span></label>
                  <input type="range" id="dia-inicio" name="dia-inicio" min="0" max="6" value="0" />
                  <label for="dia-fin">Endtag: <span id="dia-fin-label">Freitag</span></label>
                  <input type="range" id="dia-fin" name="dia-fin" min="0" max="6" value="4" />
                </div>
                <div class="slider-group">
                  <label for="hora-inicio">Startzeit: <span id="hora-inicio-label">9:00</span></label>
                  <input type="range" id="hora-inicio" name="hora-inicio" min="0" max="23" value="9" />
                  <label for="hora-fin">Endzeit: <span id="hora-fin-label">17:00</span></label>
                  <input type="range" id="hora-fin" name="hora-fin" min="0" max="23" value="17" />
                </div>
                <div class="form-group-voluntario">
                  <label for="voluntario-habilidades">F√§higkeiten</label>
                  <textarea id="voluntario-habilidades" placeholder="Beispiel: Erste Hilfe, Tischlerei, etc." required></textarea>
                </div>
                <button type="submit" class="action-btn">Mich als Freiwilliger anbieten</button>
                <button type="button" id="cancelar-voluntario" class="return-btn">Zur√ºck</button>
              </form>
            </div>
            <div id="voluntario-detail-view" style="display:none;">
              <button id="volver-voluntario-list" class="return-btn">Zur√ºck</button>
              <div id="voluntario-detail"></div>
              <!-- Privater Chat (falls zutreffend) -->
              <div id="voluntario-private-chat" class="chat-container">
                <div class="chat-header">
                  <h3>Privater Chat</h3>
                  <button type="button" class="fullscreen-chat-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/Pantalla%20completa.png?raw=true" alt="Vollbild" />
                  </button>
                </div>
                <div class="chat-messages" id="voluntario-private-chat-messages"></div>
                <form id="voluntario-private-chat-form">
                  <input type="text" id="voluntario-private-chat-input" placeholder="Schreibe deine Nachricht" required />
                  <button type="submit" class="enhanced-btn">Senden</button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <!-- Organisationen (Freiwilligenmodus) -->
        <div id="organizaciones" class="content-section" style="display:none;">
          <h2>Freiwilligenorganisationen</h2>
          <div id="org-view">
            <div id="org-list-view">
              <button id="mostrar-org-create" class="action-btn">Organisation erstellen</button>
              <div id="org-list" class="list-box"></div>
            </div>
            <div id="org-create-form" class="form-container" style="display:none;">
              <h3>Neue Organisation</h3>
              <form id="crear-org-form">
                <input type="text" id="org-title" placeholder="Titel der Organisation" required />
                <textarea id="org-info-text" placeholder="Weitere Informationen" required></textarea>
                <input type="file" id="org-image" accept="image/*" />
                <button type="submit" class="action-btn">Organisation erstellen</button>
                <button type="button" id="cancelar-org" class="return-btn">Zur√ºck</button>
              </form>
            </div>
            <div id="org-detail-view" style="display:none;">
              <button id="volver-org-list" class="return-btn">Zur√ºck</button>
              <div id="org-detail"></div>
              <div id="org-members">
                <h4>Mitglieder der Organisation:</h4>
                <ul id="org-member-list"></ul>
              </div>
              <button id="unirse-org" class="join-org-btn">Organisation beitreten</button>
              <div id="org-admin-chat" class="chat-container">
                <div class="chat-header">
                  <h3>Chat der Administratoren</h3>
                  <button type="button" class="fullscreen-chat-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/Pantalla%20completa.png?raw=true" alt="Vollbild" />
                  </button>
                </div>
                <div class="chat-messages" id="org-admin-chat-messages"></div>
                <form id="org-admin-chat-form">
                  <input type="text" id="org-admin-chat-input" placeholder="Schreibe deine Nachricht" required />
                  <button type="submit" class="enhanced-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20enviar.png?raw=true" class="send-icon" alt="Senden" />
                    Senden
                  </button>
                </form>
              </div>
              <div id="org-chat" class="chat-container">
                <div class="chat-header">
                  <h3>Organisationschat</h3>
                  <button type="button" class="fullscreen-chat-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/Pantalla%20completa.png?raw=true" alt="Vollbild" />
                  </button>
                </div>
                <div class="chat-messages" id="org-chat-messages"></div>
                <form id="org-chat-form">
                  <input type="text" id="org-chat-input" placeholder="Schreibe deine Nachricht" required />
                  <button type="submit" class="enhanced-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20enviar.png?raw=true" class="send-icon" alt="Senden" />
                    Senden
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <!-- Modul: Mein Profil -->
        <div id="perfil" class="content-section" style="display:none;">
          <h2>Mein Profil</h2>
          <div class="profile-container-new">
            <div class="profile-display">
              <div class="profile-photo-container">
                <img id="profile-large-photo" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20perfil.png?raw=true" alt="Profilfoto" onerror="this.onerror=null; this.src='https://github.com/CharliePoten/People-For-People/blob/main/icono%20perfil.png?raw=true'" />
              </div>
              <div class="profile-info">
                <h3>Profilinformationen</h3>
                <p id="profile-username-display">Benutzer: </p>
                <p id="profile-name-display">Vorname: </p>
                <p id="profile-surname-display">Nachname: </p>
                <p id="profile-dob-display">Geburtsdatum: </p>
                <p id="profile-formation-display">Berufsausbildung: </p>
                <div id="profile-attachments"></div>
              </div>
            </div>
            <div class="profile-settings">
              <h3>Profileinstellungen</h3>
              <div class="profile-tabs">
                <button type="button" class="profile-tab-btn active" data-target="profile-datos">Pers√∂nliche Daten</button>
                <button type="button" class="profile-tab-btn" data-target="profile-formacion">Berufsausbildung</button>
                <button type="button" class="profile-tab-btn" data-target="profile-foto">Foto √§ndern</button>
              </div>
              <div class="profile-tab-content" id="profile-datos" style="display:block;">
                <form id="profile-datos-form">
                  <input type="text" id="profile-nombre" placeholder="Vorname" required />
                  <input type="text" id="profile-apellido" placeholder="Nachname" required />
                  <input type="text" id="new-username" placeholder="Benutzername" />
                  <input type="date" id="profile-dob" required />
                  <input type="text" id="profile-phone" placeholder="Telefon (optional)" />
                  <button type="submit" class="enhanced-btn">Daten speichern</button>
                </form>
              </div>
              <div class="profile-tab-content" id="profile-formacion">
                <form id="profile-formacion-form">
                  <input type="text" id="profile-titulo" placeholder="Titel" required />
                  <input type="text" id="profile-institucion" placeholder="Institution" required />
                  <input type="number" id="profile-anio" placeholder="Jahr" required />
                  <button type="submit" class="enhanced-btn">Ausbildung speichern</button>
                </form>
                <div class="file-attachment">
                  <h4>Datei anh√§ngen (f√ºr allgemeinen Gebrauch)</h4>
                  <form id="profile-attachment-form">
                    <input type="text" id="attachment-title" placeholder="Dateititel" required />
                    <input type="file" id="attachment-file" accept="application/pdf, image/*, .docx" required />
                    <label for="attachment-visibility">Sichtbarkeit:</label>
                    <select id="attachment-visibility">
                      <option value="public">√ñffentlich</option>
                      <option value="private" selected>Privat</option>
                    </select>
                    <button type="submit" class="enhanced-btn">Datei anh√§ngen</button>
                  </form>
                  <div id="profile-attachment-list"></div>
                </div>
              </div>
              <div class="profile-tab-content" id="profile-foto">
                <form id="profile-foto-form">
                  <input type="file" id="profile-new-photo" accept="image/*" required />
                  <button type="submit" class="enhanced-btn">Foto aktualisieren</button>
                </form>
              </div>
              <div class="logout-section">
                <button type="button" id="logout-btn" class="logout-btn">Abmelden</button>
              </div>
            </div>
          </div>
          <div class="info-container">
            <div class="profile-info-section" id="info-center" style="display:none;">
              <h2>üìå Informationszentrum</h2>
              <h3>üåü Unsere Mission</h3>
              <p>Freiwillige und bed√ºrftige Personen verbinden: Wir erleichtern die Verbindung zwischen denen, die helfen wollen, und denen, die Unterst√ºtzung ben√∂tigen.</p>
              <p>Echtzeit-Koordination: Wir arbeiten mit NGOs und Beh√∂rden zusammen, um Hilfe effizient zu organisieren.</p>
              <h3>üì± Wie funktioniert es?</h3>
              <p>Intuitive Plattform: Unsere Anwendung erm√∂glicht es Freiwilligen, sich zu registrieren und ihre Hilfe entsprechend ihrer Verf√ºgbarkeit und F√§higkeiten anzubieten.</p>
              <p>Echtzeit-Benachrichtigungen: Freiwillige erhalten Warnungen √ºber dringenden Bedarf in ihrer Region.</p>
              <p>Zusammenarbeit mit Institutionen: Wir koordinieren unsere Bem√ºhungen mit NGOs und lokalen Beh√∂rden, um eine effektive Reaktion sicherzustellen.</p>
              <h3>ü§ù Vorteile des Beitritts</h3>
              <p>Direkter Einfluss: Ihre Hilfe erreicht direkt die, die sie am dringendsten ben√∂tigen.</p>
              <p>Flexibilit√§t: Nehmen Sie entsprechend Ihrer Verf√ºgbarkeit und F√§higkeiten teil.</p>
              <p>Solidarische Gemeinschaft: Werden Sie Teil eines Netzwerks, das sich f√ºr das gemeinsame Wohl einsetzt.</p>
              <p>üåê <a href="https://www.peopleforpeople.es/" target="_blank">Besuchen Sie unsere Webseite f√ºr weitere Informationen</a></p>
              <div id="file-upload-container" style="margin-top: 20px; display:none;">
                <h3>Datei hochladen</h3>
                <form id="file-upload-form">
                  <input type="text" id="attachment-title" placeholder="Dateititel" required />
                  <input type="file" id="attachment-file" accept="application/pdf, image/*" required />
                  <button type="submit" class="enhanced-btn">Datei hochladen</button>
                </form>
                <div id="upload-message" style="margin-top: 10px;"></div>
              </div>
            </div>
            <div class="profile-info-section" id="support" style="display:none;">
              <h2>üìû Support und Hilfe</h2>
              <p>Willkommen im Supportzentrum. Wir sind hier, um Ihnen bei Fragen oder Problemen zu helfen.</p>
              <h3>üîπ Kontakt zum Support</h3>
              <p>Wenn Sie pers√∂nliche Unterst√ºtzung ben√∂tigen, steht Ihnen unser Team zur Verf√ºgung.</p>
              <p>‚úâ E-Mail: <a href="mailto:peopleforpeopleofficial@gmail.com">peopleforpeopleofficial@gmail.com</a></p>
              <p>üìû Telefon: +34 699043862</p>
              <h3>üîπ Problem melden</h3>
              <p>Wenn Sie einen Fehler in der Anwendung feststellen, melden Sie ihn hier ‚Äì wir werden ihn so schnell wie m√∂glich beheben.</p>
              <p>üí¨ Live-Chat: W√§hrend der Gesch√§ftszeiten verf√ºgbar</p>
              <div id="soporte-live-chat">
                <div class="chat-header">
                  <h3>Live-Chat</h3>
                  <button type="button" class="fullscreen-chat-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/Pantalla%20completa.png?raw=true" alt="Vollbild" />
                  </button>
                </div>
                <div class="chat-messages" id="soporte-chat-messages" style="height:200px; overflow:auto; border:1px solid #ccc; padding:10px;"></div>
                <form id="soporte-chat-form">
                  <input type="text" id="soporte-chat-input" placeholder="Schreibe deine Nachricht" required />
                  <button type="submit" class="enhanced-btn">
                    <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20enviar.png?raw=true" class="send-icon" alt="Senden" />
                    Senden
                  </button>
                </form>
              </div>
              <h3>üîπ Vorschl√§ge und Kommentare</h3>
              <p>Ihre Meinung ist uns wichtig. Bitte hinterlassen Sie uns Ihre Vorschl√§ge zur Verbesserung Ihrer Erfahrung.</p>
              <div id="feedback-section">
                <form id="feedback-form">
                  <textarea id="feedback-text" placeholder="Schreibe deinen Kommentar hier" required></textarea>
                  <button type="submit" class="enhanced-btn">Kommentar senden</button>
                </form>
              </div>
              <button id="admin-panel-link" class="enhanced-btn">Admin-Bereich</button>
              <div id="admin-panel" style="margin-top:20px; display:none; border: 1px solid #ccc; padding: 10px;">
                <h2>Verwaltungsbereich</h2>
                <form id="admin-login-form">
                  <input type="email" id="admin-email" placeholder="Administrator-E-Mail" required />
                  <input type="password" id="admin-password" placeholder="Passwort" required />
                  <button type="submit" class="enhanced-btn">Einloggen</button>
                </form>
                <div id="admin-content" style="display:none;">
                  <button id="admin-logout-btn" class="enhanced-btn" style="float: right;">Abmelden</button>
                  <h3>Informationen bearbeiten</h3>
                  <form id="admin-edit-form">
                    <textarea id="admin-info" placeholder="Neue Informationen..." required></textarea>
                    <button type="submit" class="enhanced-btn">√Ñnderungen speichern</button>
                  </form>
                  <h3>Datei hochladen</h3>
                  <form id="admin-upload-form">
                    <input type="text" id="admin-attachment-title" placeholder="Dateititel" required />
                    <input type="file" id="admin-attachment-file" accept="application/pdf, image/*" required />
                    <button type="submit" class="enhanced-btn">Datei hochladen</button>
                  </form>
                  <div id="admin-upload-message" style="margin-top:10px;"></div>
                  <div id="admin-support-chats">
                    <h3>Offene Support-Chats</h3>
                    <div id="admin-support-chats-list" style="border:1px solid #ccc; padding:10px; max-height:200px; overflow:auto;"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Kalender (nur im Freiwilligenmodus) -->
        <div id="calendario" class="content-section" style="display: none;">
          <h2>Kalender</h2>
          <div id="calendar-controls">
            <button class="calendar-view-toggle" data-view="diario">T√§glich</button>
            <button class="calendar-view-toggle" data-view="mensual">Monatlich</button>
            <button class="calendar-add-event">Ereignis hinzuf√ºgen +</button>
          </div>
          <div id="calendar-container">
            <!-- Hier wird das Kalendergrid gerendert -->
          </div>
          <div id="event-panel">
            <h3 id="event-panel-header">Ereignis hinzuf√ºgen</h3>
            <div id="event-add-fields">
              <label>Ereignistitel:</label>
              <input type="text" id="event-title-input" placeholder="Ereignistitel" />
              <label>Ereignisinformation:</label>
              <textarea id="event-info-input" placeholder="Beschreibung des Ereignisses"></textarea>
              <div id="event-day-diary" style="display:none;">
                <label>Wochentag:</label>
                <select id="event-day-select">
                  <option value="">W√§hlen Sie einen Tag</option>
                  <option value="0">Montag</option>
                  <option value="1">Dienstag</option>
                  <option value="2">Mittwoch</option>
                  <option value="3">Donnerstag</option>
                  <option value="4">Freitag</option>
                  <option value="5">Samstag</option>
                  <option value="6">Sonntag</option>
                </select>
              </div>
              <div id="event-day-mensual" style="display:none;">
                <label>Tagesnummer:</label>
                <input type="number" id="event-day-number" placeholder="Geben Sie die Tagesnummer ein" min="1" max="31" />
              </div>
              <label>Von:</label>
              <input type="time" id="event-start-time" />
              <label>bis:</label>
              <input type="time" id="event-end-time" />
            </div>
            <div style="text-align: center;">
              <button id="event-save">Speichern</button>
              <button id="event-cancel">Abbrechen</button>
            </div>
            <div id="event-view-fields" style="display:none;">
              <h4>Titel:</h4>
              <p id="event-title-view"></p>
              <h4>Information:</h4>
              <p id="event-info-view"></p>
              <h4>Uhrzeit:</h4>
              <p id="event-time-view"></p>
              <h4>Tag:</h4>
              <p id="event-day-view"></p>
              <div style="text-align: center;">
                <button id="event-close">Schlie√üen</button>
              </div>
            </div>
          </div>
        </div>
      </main>
      <!-- Untermen√º im Freiwilligenmodus (ohne Kalender) -->
      <nav class="app-menu">
        <button class="menu-btn" data-target="map-view">
          <img class="menu-icon" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20mapa.png?raw=true" alt="Karten-Symbol" />
          Karte
        </button>
        <button class="menu-btn" data-target="pedir-ayuda">
          <img class="menu-icon" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20pedir%20ayuda.png?raw=true" alt="Hilfe anfordern Symbol" />
          Hilfe anfordern
        </button>
        <button class="menu-btn" data-target="ofrecer-voluntario">
          <img class="menu-icon" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20voluntario.png?raw=true" alt="Freiwillige Symbol" />
          Freiwillige
        </button>
        <button class="menu-btn" data-target="organizaciones">
          <img class="menu-icon" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20organizaciones.png?raw=true" alt="Organisationen Symbol" />
          Organisationen
        </button>
      </nav>
    </div>

    <!-- Modal f√ºr Dateivorschau -->
    <div id="modal-viewer" class="modal">
      <div class="modal-content"></div>
    </div>
    <!-- Modal f√ºr Datenschutzbestimmungen -->
    <div id="terms-modal">
        <span id="close-terms">&times;</span>
        <img src="https://github.com/PeopleFP/PeopleFPWeb/blob/main/nutz%201.jpeg?raw=true" alt="Datenschutz 1" />
        <img src="https://github.com/PeopleFP/PeopleFPWeb/blob/main/nutz%202.jpeg?raw=true" alt="Datenschutz 2" />
      </div>
    </div>

    <!-- Modal f√ºr Organisator-Modus: Auswahl/Erstellung einer Organisation -->
    <div id="org-mode-menu" class="modal">
      <div class="modal-content org-menu-content">
        <span class="close" id="close-org-menu">&times;</span>
        <h2>Organisator-Modus</h2>
        <div class="org-menu-container">
          <div class="org-menu-header">
            <h3>Meine Organisationen</h3>
            <button id="crear-org-organizador-btn" class="action-btn" style="background-color:#800080; color:white;">
              Organisation erstellen
            </button>
          </div>
          <div id="orgmode-list" class="list-box"></div>
          <div id="create-org-form-orgmode-container" style="display:none;" class="form-container">
            <h3>Neue Organisation erstellen</h3>
            <form id="create-org-form-orgmode">
              <input type="text" id="orgmode-title" placeholder="Titel der Organisation" required />
              <textarea id="orgmode-info" placeholder="Informationen zur Organisation" required></textarea>
              <input type="file" id="orgmode-image" accept="image/*" />
              <button type="submit" class="action-btn">Organisation erstellen</button>
              <button type="button" id="cancelar-org-modal" class="return-btn">Abbrechen</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Anwendung Organisator-Modus -->
    <div id="org-mode-app" class="screen org-mode" style="display:none;">
      <header class="app-header org-header">
        <h1 class="app-title">Organisator-Modus</h1>
      </header>
      <main class="app-content org-content">
        <!-- Chats Bereich -->
        <div id="org-chats" class="org-content-section" style="display:none;">
          <div id="org-chat-public" class="chat-container">
            <h3>√ñffentlicher Chat</h3>
            <div class="chat-messages" id="org-chat-messages-public"></div>
            <form id="org-chat-form-public">
              <input type="text" id="org-chat-input-public" placeholder="Schreibe deine Nachricht" required />
              <input type="file" id="org-chat-file-public" accept="image/*, application/pdf" />
              <button type="submit" class="enhanced-btn">
                <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20enviar.png?raw=true" class="send-icon" alt="Senden" />
                Senden
              </button>
            </form>
          </div>
          <div id="org-chat-admin" class="chat-container">
            <h3>Chat der Administratoren</h3>
            <div class="chat-messages" id="org-admin-chat-messages"></div>
            <form id="org-admin-chat-form">
              <input type="text" id="org-admin-chat-input" placeholder="Schreibe deine Nachricht" required />
              <input type="file" id="org-admin-chat-file" accept="image/*, application/pdf" />
              <button type="submit" class="enhanced-btn">
                <img src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20enviar.png?raw=true" class="send-icon" alt="Senden" />
                Senden
              </button>
            </form>
          </div>
        </div>
        <!-- Informationsbereich -->
        <div id="org-info" class="org-content-section" style="display:none;">
          <h2>Informationszentrum</h2>
          <div id="org-info-display" class="org-info-display">
            <p id="org-info-titulo">Titel: </p>
            <p id="org-info-creador">Ersteller: </p>
            <p id="org-info-detalle">Information: </p>
            <p id="org-info-lugar">Ort: </p>
            <p id="org-info-fecha">Erstellungsdatum: </p>
            <div id="org-info-attachments" class="attachment-display"></div>
            <button id="btn-editar-info" class="action-btn">Informationen bearbeiten</button>
          </div>
          <div id="org-info-edit" class="org-info-edit" style="display:none;">
            <h3>Informationen bearbeiten</h3>
            <form id="org-info-edit-form">
              <div>
                <label for="edit-org-titulo">Titel:</label>
                <input type="text" id="edit-org-titulo" placeholder="Titel" required />
              </div>
              <div>
                <label for="edit-org-creador">Ersteller:</label>
                <input type="text" id="edit-org-creador" placeholder="Ersteller" disabled />
              </div>
              <div>
                <label for="edit-org-detalle">Informationen:</label>
                <textarea id="edit-org-detalle" placeholder="Informationen" required></textarea>
              </div>
              <div>
                <label for="edit-org-lugar">Ort:</label>
                <input type="text" id="edit-org-lugar" placeholder="Ort" required />
              </div>
              <div>
                <label for="edit-org-fecha">Erstellungsdatum:</label>
                <input type="date" id="edit-org-fecha" placeholder="Datum" disabled />
              </div>
              <button type="submit" class="action-btn">√Ñnderungen speichern</button>
              <button type="button" id="cancelar-editar-info" class="return-btn">Abbrechen</button>
            </form>
            <h3>Datei hochladen</h3>
            <form id="org-file-upload-form" class="form-container">
              <input type="text" id="org-file-title" placeholder="Titel der Datei" required />
              <input type="file" id="org-file-upload" accept="application/pdf, image/*" required />
              <button type="submit" class="action-btn">Datei hochladen</button>
            </form>
          </div>
        </div>
        <!-- Meine Organisationen -->
        <div id="org-list" class="org-content-section" style="display:none;">
          <h2>Meine Organisationen</h2>
          <div class="org-list-container">
            <div id="org-list-organizador" class="list-box"></div>
            <button id="crear-org-btn-organizador" class="action-btn" style="background-color:#800080; color:white;">
              Organisation erstellen
            </button>
          </div>
        </div>
        <!-- Startseite (Organisator-Modus) -->
        <div id="org-mode-home" class="org-content-section" style="display:block;">
          <p>Willkommen im Organisator-Modus. W√§hlen Sie eine Option im unteren Men√º.</p>
        </div>
      </main>
      <nav class="app-menu org-app-menu">
        <button class="menu-btn org-menu-btn" data-target="org-chats">
          <img class="menu-icon" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20chats.png?raw=true" alt="Chats-Symbol" />
          Chat-Zentrum
        </button>
        <button class="menu-btn org-menu-btn" data-target="org-info">
          <img class="menu-icon" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20informacion.png?raw=true" alt="Informations-Symbol" />
          People for People
        </button>
        <button class="menu-btn org-menu-btn" data-target="org-list">
          <img class="menu-icon" src="https://github.com/CharliePoten/People-For-People/blob/main/icono%20listas.png?raw=true" alt="Meine Organisationen Symbol" />
          Meine Organisationen
        </button>
      </nav>
    </div>

    <!-- Modal f√ºr Dateivorschau -->
    <div id="modal-viewer" class="modal">
      <div class="modal-content"></div>
    </div>

    <!-- Modal f√ºr Organisator-Modus: Auswahl/Erstellung einer Organisation -->
    <div id="org-mode-menu" class="modal">
      <div class="modal-content org-menu-content">
        <span class="close" id="close-org-menu">&times;</span>
        <h2>Organisator-Modus</h2>
        <div class="org-menu-container">
          <div class="org-menu-header">
            <h3>Meine Organisationen</h3>
            <button id="crear-org-organizador-btn" class="action-btn" style="background-color:#800080; color:white;">
              Organisation erstellen
            </button>
          </div>
          <div id="orgmode-list" class="list-box"></div>
          <div id="create-org-form-orgmode-container" style="display:none;" class="form-container">
            <h3>Neue Organisation erstellen</h3>
            <form id="create-org-form-orgmode">
              <input type="text" id="orgmode-title" placeholder="Titel der Organisation" required />
              <textarea id="orgmode-info" placeholder="Informationen zur Organisation" required></textarea>
              <input type="file" id="orgmode-image" accept="image/*" />
              <button type="submit" class="action-btn">Organisation erstellen</button>
              <button type="button" id="cancelar-org-modal" class="return-btn">Abbrechen</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Neuer Begr√º√üungsbildschirm -->
    <div id="welcome-screen" style="display: none;">
      <div class="container">
        <h1 class="welcome-text" id="welcomeText"></h1>
        <img src="https://github.com/CharliePoten/People-For-People/blob/main/Logo%20People%20For%20People%20(2).png?raw=true" alt="Logo Menschen f√ºr Menschen" class="logo" />
        <p class="slogan">Helfen wollen und Hilfe brauche. Wir verbinden!</p>
        <button id="start-btn" class="action-btn">Starten</button>
      </div>
      <style>
        /* Die spezifischen Styles f√ºr #welcome-screen sind bereits im globalen Block definiert */
      </style>
    </div>

    <!-- Asynchrones Laden von Google Maps -->
    <script>
      window.onload = function () {
        const script = document.createElement("script");
        script.src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyBWlVP6ZrRsXVmKj4czhWxg6Q4bGIP8zeE&callback=initMap&v=weekly";
        script.async = true;
        script.defer = true;
        document.head.appendChild(script);
      };
    </script>

    <!-- Script f√ºr √úberg√§nge, Animation und Effekte -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const fullWelcomeText = "Willkommen bei People for People";
        const welcomeTextElem = document.getElementById("welcomeText");
        let charIndex = 0;
    
        function typeWriter() {
          if (charIndex < fullWelcomeText.length) {
            welcomeTextElem.textContent += fullWelcomeText.charAt(charIndex);
            charIndex++;
            setTimeout(typeWriter, 100);
          } else {
            setTimeout(startWaveAnimation, 1000);
          }
        }
    
        function startWaveAnimation() {
          const letters = fullWelcomeText.split("");
          welcomeTextElem.innerHTML = letters
            .map(letter =>
              letter === " " ? `<span class="wave-letter" style="animation: none;">&nbsp;</span>` : `<span class="wave-letter">${letter}</span>`
            )
            .join("");
    
          function animateLetters() {
            const waveLetters = welcomeTextElem.querySelectorAll(".wave-letter");
            waveLetters.forEach((letter, i) => {
              if (letter.innerHTML.trim() !== "") {
                setTimeout(() => {
                  letter.classList.add("animate-wave");
                  letter.addEventListener("animationend", () => {
                    letter.classList.remove("animate-wave");
                  }, { once: true });
                }, i * 100);
              }
            });
            setTimeout(animateLetters, 7000);
          }
          animateLetters();
        }
    
        typeWriter();
    
        const registrationForm = document.getElementById("registration-form");
        registrationForm.addEventListener("submit", function (e) {
          e.preventDefault();
          const registrationScreen = document.getElementById("registration-screen");
          registrationScreen.classList.add("fade-out");
          registrationScreen.addEventListener("transitionend", function handler() {
            registrationScreen.style.display = "none";
            registrationScreen.classList.remove("fade-out");
    
            const welcomeScreen = document.getElementById("welcome-screen");
            welcomeScreen.style.display = "flex";
            void welcomeScreen.offsetWidth;
            welcomeScreen.classList.add("visible");
            welcomeTextElem.textContent = "";
            charIndex = 0;
            typeWriter();
            const sloganEl = document.querySelector("#welcome-screen .slogan");
            const startBtnEl = document.querySelector("#welcome-screen #start-btn");
            void sloganEl.offsetWidth;
            void startBtnEl.offsetWidth;
            setTimeout(() => {
              sloganEl.classList.add("show");
              startBtnEl.classList.add("show");
              setTimeout(() => { startBtnEl.classList.add("pulse"); }, 2000);
            }, 100);
            registrationScreen.removeEventListener("transitionend", handler);
          });
        });
    
        setTimeout(function () {
          const registrationScreen = document.getElementById("registration-screen");
          if (window.getComputedStyle(registrationScreen).display === "none") {
            const welcomeScreen = document.getElementById("welcome-screen");
            welcomeTextElem.textContent = "";
            charIndex = 0;
            welcomeScreen.style.display = "flex";
            void welcomeScreen.offsetWidth;
            welcomeScreen.classList.add("visible");
            typeWriter();
            const sloganEl = document.querySelector("#welcome-screen .slogan");
            const startBtnEl = document.querySelector("#welcome-screen #start-btn");
            void sloganEl.offsetWidth;
            void startBtnEl.offsetWidth;
            setTimeout(() => {
              sloganEl.classList.add("show");
              startBtnEl.classList.add("show");
              setTimeout(() => { startBtnEl.classList.add("pulse"); }, 2000);
            }, 100);
          }
        }, 50);
    
        const startBtn = document.getElementById("start-btn");
        startBtn.addEventListener("click", function () {
          startBtn.classList.remove("pulse");
          const welcomeScreen = document.getElementById("welcome-screen");
          welcomeScreen.classList.add("fade-out");
          welcomeScreen.addEventListener("transitionend", function handler() {
            welcomeScreen.style.display = "none";
            document.getElementById("main-app").style.display = "block";
            welcomeScreen.removeEventListener("transitionend", handler);
          });
        });
    
        // Vollbild f√ºr Chats
        const fullscreenButtons = document.querySelectorAll('.fullscreen-chat-btn');
        fullscreenButtons.forEach(button => {
          button.addEventListener('click', function (e) {
            const chatContainer = this.closest('.chat-container');
            if (chatContainer) {
              if (!document.fullscreenElement) {
                chatContainer.requestFullscreen().catch(err => {
                  console.error(`Fehler beim Aktivieren des Vollbildmodus: ${err.message}`);
                });
              } else {
                document.exitFullscreen();
              }
            }
          });
        });
    
        // Men√º-Funktionalit√§t (Freiwilligenmodus)
        document.querySelectorAll('.menu-btn').forEach(btn => {
          btn.addEventListener('click', function () {
            document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            document.querySelectorAll('.content-section').forEach(sec => { sec.style.display = "none"; });
            const eventPanel = document.getElementById("event-panel");
            if (eventPanel) { eventPanel.style.display = "none"; }
            let target = this.getAttribute("data-target");
            if (target) { document.getElementById(target).style.display = "block"; }
          });
        });
    
        // Kalender-Button im Header (Freiwilligenmodus)
        document.getElementById("calendario-btn").addEventListener("click", function() {
          document.querySelectorAll('.content-section').forEach(sec => { sec.style.display = "none"; });
          document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
          document.getElementById("calendario").style.display = "block";
        });
    
        // Moduswechsel (Freiwillig/Organisator)
        let organizerMode = false;
        const modeToggleBtn = document.querySelector(".mode-toggle-btn");
        if (modeToggleBtn) {
          modeToggleBtn.addEventListener("click", function() {
            organizerMode = !organizerMode;
            if (organizerMode) {
              // Wechsel in den Organisator-Modus:
              // Freiwilligenanwendung (main-app) ausblenden und org-mode-app anzeigen
              document.getElementById("main-app").style.display = "none";
              document.getElementById("org-mode-app").style.display = "block";
              // Kalender-Icon (nur im Freiwilligenmodus) ausblenden
              document.getElementById("calendario-btn").classList.remove("visible");
              this.textContent = "Zum Freiwilligen wechseln";
            } else {
              // Zur√ºck in den Freiwilligenmodus:
              document.getElementById("org-mode-app").style.display = "none";
              document.getElementById("main-app").style.display = "block";
              // Kalender-Icon anzeigen
              document.getElementById("calendario-btn").classList.add("visible");
              this.textContent = "Zum Organisator wechseln";
            }
          });
        }
      });
    </script>

    <!-- Script f√ºr den Kalender (Freiwilligenmodus) -->
    <script>
      document.addEventListener("DOMContentLoaded", function(){
        (function(){
          const diarioTimes = [
            { start: "08:00", end: "10:00" },
            { start: "10:00", end: "12:00" },
            { start: "12:00", end: "14:00" },
            { start: "14:00", end: "16:00" }
          ];
          const semanalTimes = [
            { start: "08:00", end: "10:00" },
            { start: "10:00", end: "12:00" },
            { start: "12:00", end: "14:00" },
            { start: "14:00", end: "16:00" },
            { start: "16:00", end: "18:00" }
          ];
          const dayNames = ["Mo", "Di", "Mi", "Do", "Fr", "Sa", "So"];
      
          let currentView = "diario";
          const calendarContainer = document.getElementById("calendar-container");
          const viewToggleButtons = document.querySelectorAll(".calendar-view-toggle");
          const addEventButton = document.querySelector(".calendar-add-event");
          const currentUser = localStorage.getItem("username") || "Du";
          const eventsKey = "calendarEvents_" + currentUser;
          let events = [];
          try {
            events = JSON.parse(localStorage.getItem(eventsKey)) || [];
          } catch (error) {
            console.error("Error beim Lesen der Ereignisse", error);
            events = [];
          }
      
          function saveEvents() {
            localStorage.setItem(eventsKey, JSON.stringify(events));
          }
      
          function renderCalendar() {
            calendarContainer.innerHTML = "";
            if (currentView === "diario") {
              renderDiarioView();
            } else if (currentView === "mensual") {
              renderMonthlyView();
            }
          }
      
          function renderDiarioView() {
            const headerRow = document.createElement("div");
            headerRow.className = "daily-header-row";
            const leftHeader = document.createElement("span");
            leftHeader.innerText = "Tag";
            const rightHeader = document.createElement("span");
            rightHeader.innerText = "Ereignisse";
            headerRow.appendChild(leftHeader);
            headerRow.appendChild(rightHeader);
            calendarContainer.appendChild(headerRow);
      
            const container = document.createElement("div");
            container.className = "daily-list";
            for (let i = 0; i < 7; i++) {
              const row = document.createElement("div");
              row.className = "daily-row";
              row.dataset.day = i;
      
              const leftCell = document.createElement("div");
              leftCell.className = "day-name";
              leftCell.innerText = dayNames[i];
      
              const rightCell = document.createElement("div");
              rightCell.className = "event-info";
              const eventObj = events.find(ev =>
                ev.view === "diario" && parseInt(ev.day, 10) === i
              );
              if (eventObj) {
                rightCell.innerText = eventObj.title + " (" + eventObj.startTime + " bis " + eventObj.endTime + ")";
                rightCell.style.color = "#32cd32";
                rightCell.addEventListener("click", function(e) {
                  e.stopPropagation();
                  showEventView(eventObj);
                });
              } else {
                rightCell.innerText = "Keine Ereignisse";
              }
              row.appendChild(leftCell);
              row.appendChild(rightCell);
              row.addEventListener("click", function() {
                showEventPanel({ view: "diario", day: i });
              });
              container.appendChild(row);
            }
            calendarContainer.appendChild(container);
          }
      
          function renderMonthlyView() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const numDays = new Date(year, month + 1, 0).getDate();
      
            const header = document.createElement("div");
            header.className = "monthly-header";
            dayNames.forEach(day => {
              const d = document.createElement("div");
              d.innerText = day;
              header.appendChild(d);
            });
            calendarContainer.appendChild(header);
      
            const grid = document.createElement("div");
            grid.className = "monthly-grid";
            for (let day = 1; day <= numDays; day++) {
              const cell = document.createElement("div");
              cell.className = "calendar-cell";
              cell.innerText = day;
              const eventObj = events.find(ev =>
                ev.view === "mensual" && parseInt(ev.dayNumber, 10) === day
              );
              if (eventObj) {
                const evDiv = document.createElement("div");
                evDiv.className = "event-data";
                evDiv.style.background = "#32cd32";
                evDiv.style.color = "#fff";
                evDiv.style.padding = "2px 4px";
                evDiv.style.borderRadius = "4px";
                evDiv.style.position = "absolute";
                evDiv.style.bottom = "5px";
                evDiv.style.left = "5px";
                evDiv.style.right = "5px";
                evDiv.style.overflow = "hidden";
                evDiv.style.whiteSpace = "nowrap";
                evDiv.style.textOverflow = "ellipsis";
                evDiv.innerText = eventObj.title;
                evDiv.addEventListener("click", function(e) {
                  e.stopPropagation();
                  showEventView(eventObj);
                });
                cell.appendChild(evDiv);
              } else {
                cell.addEventListener("click", function() {
                  showEventPanel({ view: "mensual", dayNumber: day });
                });
              }
              grid.appendChild(cell);
            }
            calendarContainer.appendChild(grid);
          }
      
          let currentEventContext = null;
      
          function showEventPanel(context) {
            currentEventContext = context;
            document.getElementById("event-panel-header").innerText = "Ereignis hinzuf√ºgen";
            document.getElementById("event-add-fields").style.display = "block";
            document.getElementById("event-view-fields").style.display = "none";
      
            if (currentView === "diario") {
              document.getElementById("event-day-diary").style.display = "block";
              document.getElementById("event-day-mensual").style.display = "none";
              if (typeof context.day !== "undefined") {
                document.getElementById("event-day-select").value = context.day;
                if (context.slot !== undefined) {
                  const slotData = diarioTimes[context.slot] || { start: "", end: "" };
                  document.getElementById("event-start-time").value = slotData.start;
                  document.getElementById("event-end-time").value = slotData.end;
                }
              }
            } else if (currentView === "mensual") {
              document.getElementById("event-day-diary").style.display = "none";
              document.getElementById("event-day-mensual").style.display = "block";
              if (typeof context.dayNumber !== "undefined") {
                document.getElementById("event-day-number").value = context.dayNumber;
              }
            }
            document.getElementById("event-title-input").value = "";
            document.getElementById("event-info-input").value = "";
            document.getElementById("event-panel").style.display = "block";
          }
      
          function showEventView(eventObj) {
            currentEventContext = null;
            document.getElementById("event-panel-header").innerText = "Ereignisdetails";
            document.getElementById("event-add-fields").style.display = "none";
            document.getElementById("event-view-fields").style.display = "block";
            document.getElementById("event-title-view").innerText = eventObj.title;
            document.getElementById("event-info-view").innerText = eventObj.info || "";
            if (eventObj.view === "diario") {
              document.getElementById("event-day-view").innerText = dayNames[eventObj.day];
            } else if (eventObj.view === "mensual") {
              document.getElementById("event-day-view").innerText = eventObj.dayNumber;
            }
            document.getElementById("event-time-view").innerText = eventObj.startTime + " bis " + eventObj.endTime;
            document.getElementById("event-panel").style.display = "block";
          }
      
          function hideEventPanel() {
            document.getElementById("event-panel").style.display = "none";
            currentEventContext = null;
          }
      
          document.getElementById("event-save").addEventListener("click", function(){
            const title = document.getElementById("event-title-input").value.trim();
            const info = document.getElementById("event-info-input").value.trim();
            const startTime = document.getElementById("event-start-time").value;
            const endTime = document.getElementById("event-end-time").value;
            if (title && startTime && endTime) {
              let newEvent = {
                id: Date.now(),
                title: title,
                info: info,
                startTime: startTime,
                endTime: endTime,
                view: currentView
              };
              if (currentView === "diario") {
                const day = document.getElementById("event-day-select").value;
                if (day === "") return;
                newEvent.day = parseInt(day, 10);
              } else if (currentView === "mensual") {
                const dayNum = document.getElementById("event-day-number").value;
                if (dayNum === "") return;
                newEvent.dayNumber = parseInt(dayNum, 10);
              }
              events.push(newEvent);
              saveEvents();
              renderCalendar();
              hideEventPanel();
            }
          });
      
          document.getElementById("event-cancel").addEventListener("click", function(){
            hideEventPanel();
          });
          document.getElementById("event-close").addEventListener("click", function(){
            hideEventPanel();
          });
      
          viewToggleButtons.forEach(button=>{
            button.addEventListener("click", function(){
              currentView = this.dataset.view;
              viewToggleButtons.forEach(btn => btn.classList.remove("active"));
              this.classList.add("active");
              renderCalendar();
            });
          });
      
          addEventButton.addEventListener("click", function(){
            showEventPanel({});
          });
      
          if (document.querySelector('.calendar-view-toggle[data-view="diario"]')) {
            document.querySelector('.calendar-view-toggle[data-view="diario"]').classList.add("active");
          }
          renderCalendar();
        })();
      });
    </script>
    <!-- Script f√ºr das Modal der Datenschutzbestimmungen -->
    <script>
      function openTermsModal() {
        document.getElementById("terms-modal").style.display = "block";
      }
      function closeTermsModal() {
        document.getElementById("terms-modal").style.display = "none";
      }
      document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("close-terms").addEventListener("click", closeTermsModal);
        // Schlie√üt das Modal, wenn au√üerhalb des Inhalts geklickt wird
        window.addEventListener("click", function(event) {
          var modal = document.getElementById("terms-modal");
          if (event.target === modal) {
            modal.style.display = "none";
          }
        });
      });
    </script>
  </body>
</html>
